--- RUN: main\tests_organized\functional\test_password_reset.py
--- CMD: C:\Users\hemja\OneDrive\Desktop\Last Cleanup\.venv\Scripts\python.exe "C:\Users\hemja\OneDrive\Desktop\Last Cleanup\main\tests_organized\functional\test_password_reset.py"
--- OUTPUT ---
ğŸ”‘ TESTING PASSWORD RESET SYSTEM
==================================================

1ï¸âƒ£ Testing Password Reset Token Model:
âœ… Found existing test user: password_test_user
âœ… Token created successfully
   Token: f57f85d2-2394-4584-aef4-afdff3960f85
   User: password_test_user
   Expires: 2025-10-13 18:45:14.940630+00:00
   Is expired: False
   Is used: False

2ï¸âƒ£ Testing Token Expiry Logic:
âœ… Expired token test:
   Expires at: 2025-10-13 17:15:14.946775+00:00
   Current time: 2025-10-13 17:45:14.949928+00:00
   Is expired: True
âœ… Expiry logic working correctly

3ï¸âƒ£ Available Users for Testing:
ğŸ‘¥ Users with email addresses (22):
   ğŸ“§ vendor1 (vendor1@example.com) - 0 tokens
   ğŸ“§ vendor2 (vendor2@example.com) - 0 tokens
   ğŸ“§ vendor3 (vendor3@example.com) - 0 tokens
   ğŸ“§ buyer1 (buyer1@example.com) - 0 tokens
   ğŸ“§ buyer2 (buyer2@example.com) - 0 tokens

4ï¸âƒ£ Testing URL Patterns:
ğŸ“ Password Reset URLs:
   Request: http://127.0.0.1:8000/password-reset/
   Confirm: http://127.0.0.1:8000/password-reset/f57f85d2-2394-4584-aef4-afdff3960f85/

5ï¸âƒ£ Checking Template Files:
âŒ password_reset_request.html - Missing!
âŒ password_reset_confirm.html - Missing!

6ï¸âƒ£ Email Configuration Check:
   EMAIL_BACKEND: django.core.mail.backends.console.EmailBackend
   EMAIL_HOST: smtp.gmail.com
   EMAIL_PORT: 587
   DEFAULT_FROM_EMAIL: noreply@himalayanecommerce.com

7ï¸âƒ£ Security Features Implemented:
   âœ… UUID-based tokens (non-guessable)
   âœ… Token expiration (1 hour)
   âœ… Single-use tokens (marked as used)
   âœ… Email validation before sending
   âœ… Automatic token invalidation
   âœ… HTML and plain text email support
   âœ… Secure password strength requirements
   âœ… Password confirmation validation
   âœ… User feedback and error handling

8ï¸âƒ£ MANUAL TESTING INSTRUCTIONS:
===================================
ğŸ” Step-by-step testing:
1. Visit: http://127.0.0.1:8000/login/
2. Click 'Forgot your password?' link
3. Enter email address of existing user
4. Check email for reset link (if email configured)
5. Click reset link to set new password
6. Test login with new password

ğŸ“§ Email Testing:
- Configure email settings in project_settings.py
- For testing, you can use console email backend:
  EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

ğŸ” Test Cases to Verify:
   1. Valid email address â†’ Reset link sent
   2. Invalid email address â†’ Security message (no reveal)
   3. Expired token â†’ Error message and redirect
   4. Used token â†’ Error message and redirect
   5. Strong password â†’ Accepted
   6. Weak password â†’ Rejected with feedback
   7. Mismatched passwords â†’ Validation error
   8. Successful reset â†’ Login with new password

ğŸ§¹ Cleaning up test tokens...
   Deleted 2 test tokens

âœ… PASSWORD RESET SYSTEM TEST COMPLETE!
ğŸŒ Ready for testing at: http://127.0.0.1:8000/password-reset/

--- EXIT CODE: 0
